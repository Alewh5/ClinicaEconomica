import{u as S,r as g,o as j,c as r,a as e,b as C,w as F,d as c,e as p,f as b,l as k,n as v,F as x,s as V,v as f,t as u,g as I,h as i,x as A,k as z}from"./index-ca603161.js";import{s as L}from"./function-124e4072.js";import{x as H}from"./index-d159f55b.js";import"./sweetalert2.all-4f88cff0.js";const N={class:"flex justify-between items-center"},O=e("h3",{class:"sm:text-2xl text-lg font-semibold text-gray-700"}," Cargar o Descargar Productos ",-1),q={class:"flex flex-col items-start w-26 sm:flex-row sm:items-center"},E=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-box-arrow-left h-4 w-4 mr-2",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0z"}),e("path",{"fill-rule":"evenodd",d:"M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708z"})],-1),R=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-floppy-fill h-4 w-4 mr-2",viewBox:"0 0 16 16"},[e("path",{d:"M0 1.5A1.5 1.5 0 0 1 1.5 0H3v5.5A1.5 1.5 0 0 0 4.5 7h7A1.5 1.5 0 0 0 13 5.5V0h.086a1.5 1.5 0 0 1 1.06.44l1.415 1.414A1.5 1.5 0 0 1 16 2.914V14.5a1.5 1.5 0 0 1-1.5 1.5H14v-5.5A1.5 1.5 0 0 0 12.5 9h-9A1.5 1.5 0 0 0 2 10.5V16h-.5A1.5 1.5 0 0 1 0 14.5z"}),e("path",{d:"M3 16h10v-5.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5zm9-16H4v5.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5zM9 1h2v4H9z"})],-1),G={class:"mt-6"},Z={class:"px-4 pb-8 pt-5 bg-white shadow-md"},J={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},K={class:"text-gray-700",for:"cellar_id"},Q={key:0,class:"text-red-500 mt-1 text-sm"},W={class:"flex mt-2"},X=e("div",{class:"flex items-center justify-center rounded-tl-lg rounded-bl-lg border-y border-l relative border-gray-400 bg-white p-5"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-check2-square pointer-events-none absolute w-5 h-5 fill-gray-500 transition",viewBox:"0 0 16 16"},[e("path",{d:"M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5z"}),e("path",{d:"m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0"})])],-1),Y=e("option",{value:"",disabled:""},"Selecciona una bodega",-1),ee=["value"],te={key:0,disabled:""},oe={class:"text-gray-700",for:"fecha"},se={key:0,class:"text-red-500 mt-1 text-sm"},ae={class:"flex mt-2"},le=e("div",{class:"flex items-center justify-center rounded-tl-lg rounded-bl-lg border-y border-l relative border-gray-400 bg-white p-5"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-calendar-check pointer-events-none absolute w-5 h-5 fill-gray-500 transition",viewBox:"0 0 16 16"},[e("path",{d:"M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"}),e("path",{d:"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"})])],-1),re={class:"text-gray-700",for:"tipoMovimiento"},ie={key:0,class:"text-red-500 mt-1 text-sm"},ne={class:"flex mt-2"},de=e("div",{class:"flex items-center justify-center rounded-tl-lg rounded-bl-lg border-y border-l relative border-gray-400 bg-white p-5"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-check2-square pointer-events-none absolute w-5 h-5 fill-gray-500 transition",viewBox:"0 0 16 16"},[e("path",{d:"M3 14.5A1.5 1.5 0 0 1 1.5 13V3A1.5 1.5 0 0 1 3 1.5h8a.5.5 0 0 1 0 1H3a.5.5 0 0 0-.5.5v10a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V8a.5.5 0 0 1 1 0v5a1.5 1.5 0 0 1-1.5 1.5z"}),e("path",{d:"m8.354 10.354 7-7a.5.5 0 0 0-.708-.708L8 9.293 5.354 6.646a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0"})])],-1),ce=e("option",{value:"1"},"Suministrar",-1),ue=e("option",{value:"0"},"Desabastecer",-1),he=[ce,ue],pe={class:"text-gray-700",for:"concepto"},ge={key:0,class:"text-red-500 mt-1 text-sm"},be={class:"flex mt-2"},ve=e("div",{class:"flex items-center justify-center rounded-tl-lg rounded-bl-lg border-y border-l relative border-gray-400 bg-white p-5"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-alphabet-uppercase pointer-events-none absolute w-5 h-5 fill-gray-500 transition",viewBox:"0 0 16 16"},[e("path",{d:"M1.226 10.88H0l2.056-6.26h1.42l2.047 6.26h-1.29l-.48-1.61H1.707l-.48 1.61ZM2.76 5.818h-.054l-.75 2.532H3.51zm3.217 5.062V4.62h2.56c1.09 0 1.808.582 1.808 1.54 0 .762-.444 1.22-1.05 1.372v.055c.736.074 1.365.587 1.365 1.528 0 1.119-.89 1.766-2.133 1.766zM7.18 5.55v1.675h.8c.812 0 1.171-.308 1.171-.853 0-.51-.328-.822-.898-.822zm0 2.537V9.95h.903c.951 0 1.342-.312 1.342-.909 0-.591-.382-.954-1.095-.954zm5.089-.711v.775c0 1.156.49 1.803 1.347 1.803.705 0 1.163-.454 1.212-1.096H16v.12C15.942 10.173 14.95 11 13.607 11c-1.648 0-2.573-1.073-2.573-2.849v-.78c0-1.775.934-2.871 2.573-2.871 1.347 0 2.34.849 2.393 2.087v.115h-1.172c-.05-.665-.516-1.156-1.212-1.156-.849 0-1.347.67-1.347 1.83"})])],-1),me={class:"grid grid-cols-1 mt-6 sm:grid-cols-2 lg:grid-cols-2"},_e={class:"relative"},xe={class:"text-gray-700",for:"searchProduct"},fe={key:0,class:"text-red-500 mt-1 text-sm"},we={class:"flex mt-2"},ye=e("div",{class:"flex items-center justify-center rounded-tl-lg rounded-bl-lg border-y border-l relative border-gray-400 bg-white p-5"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-search-heart pointer-events-none absolute w-5 h-5 fill-gray-500 transition",viewBox:"0 0 16 16"},[e("path",{d:"M6.5 4.482c1.664-1.673 5.825 1.254 0 5.018-5.825-3.764-1.664-6.69 0-5.018"}),e("path",{d:"M13 6.5a6.47 6.47 0 0 1-1.258 3.844q.06.044.115.098l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1-.1-.115h.002A6.5 6.5 0 1 1 13 6.5M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11"})])],-1),Ce={key:0,class:"mt-4 absolute top-16 bg-white border rounded border-gray-300 w-full overflow-y-auto"},Ve={class:"font-medium"},Me={class:"inline-flex px-2 text-xs font-semibold leading-5 text-green-800 bg-green-100 rounded-full"},ke=["onClick"],Ae={class:"py-2 my-2 overflow-x-auto overflow-y-auto sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8"},ze={class:"inline-block min-w-full overflow-hidden align-middle border-b border-gray-200 shadow rounded"},He={class:"min-w-full"},Be=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-2 text-xs font-bold leading-4 tracking-wider text-left text-white uppercase bg-gray-900 border-b border-gray-200"}," Productos "),e("th",{class:"px-6 py-2 text-xs font-bold leading-4 tracking-wider text-left text-white uppercase bg-gray-900 border-b border-gray-200"}," Detalles "),e("th",{class:"px-6 py-2 text-xs font-bold leading-4 tracking-wider text-center text-white uppercase bg-gray-900 border-b border-gray-200"}," Cantidad "),e("th",{class:"px-6 py-2 text-xs font-bold leading-4 tracking-wider text-center text-white uppercase bg-gray-900 border-b border-gray-200"}," Costo Unitario "),e("th",{class:"px-6 py-2 text-xs font-bold leading-4 tracking-wider text-center text-white uppercase bg-gray-900 border-b border-gray-200"}," Costo Total "),e("th",{class:"px-6 py-2 text-xs font-bold leading-4 tracking-wider text-center text-white uppercase bg-gray-900 border-b border-gray-200"}," Acciones ")])],-1),Pe={class:"bg-white"},Ue={class:"px-6 py-2 border-b border-gray-200 whitespace-nowrap"},Te={class:"text-sm font-medium leading-5 text-gray-900"},$e={class:"text-sm leading-5 text-gray-900 whitespace-normal"},De={class:"px-6 py-2 border-b border-gray-200 whitespace-nowrap"},Se={class:"text-sm leading-5 text-gray-900"},je=e("span",{class:"font-semibold"},"MARCA:",-1),Fe={class:"text-sm leading-5 text-gray-900"},Ie=e("span",{class:"font-semibold"},"CATEGORIA:",-1),Le={class:"px-3 py-2 border-b border-gray-200 whitespace-nowrap text-center"},Ne=["onUpdate:modelValue","onChange"],Oe={class:"px-1 py-4 border-b border-gray-200 whitespace-nowrap text-center"},qe={class:"px-1 py-4 border-b border-gray-200 whitespace-nowrap text-center"},Ee={class:"px-1 py-2 border-b border-gray-200 whitespace-nowrap text-center"},Re={class:"flex items-center justify-center"},Ge=["onClick"],Ze=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash3-fill",viewBox:"0 0 16 16"},[e("path",{d:"M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5m-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5M4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06m6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528M8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5"})],-1),Je=[Ze],Ke=e("td",{colspan:"4",class:"text-right font-semibold px-6 py-2 bg-white"},"Total:",-1),Qe={class:"text-center font-semibold px-6 py-2 bg-white"},We=e("td",null,null,-1),st={__name:"Create",setup(Xe){const B=S();axios.defaults.headers.common.Authorization="Bearer "+B.authToken;const s=g({cellar_id:"",fecha:new Date().toISOString().split("T")[0],tipoMovimiento:1,concepto:"",total:"",products:[]}),w=g([]),m=g(""),M=g([]),P=async a=>{const o=await axios.get(`/cellars?page=${a}`);w.value=o.data.data},U=async()=>{const a=await axios.get(`/products?search=${m.value}`);M.value=a.data.data},_=g([]),T=a=>{const o=s.value.products.findIndex(h=>h.product_id===a.id);o!==-1?s.value.products[o].cantidad++:(s.value.products.push({product_id:a.id,cantidad:1,costo_unitario:"",costo_total:""}),_.value.push({product_codigo:a.codigo,product_descripcion:a.descripcion,product_marca:a.marca,product_categoria:a.categoria})),m.value=""},$=async a=>{s.value.products.splice(a,1),s.value.total=s.value.products.reduce((o,h)=>o+h.costo_total,0)},y=async a=>{a.costo_total=a.cantidad*a.costo_unitario,s.value.total=s.value.products.reduce((o,h)=>o+h.costo_total,0)},l=g({}),D=async()=>{const{status:a,list_errors:o}=await L("POST",s.value,"/movements","/products");a==422&&(l.value=o)};return j(()=>{P(1)}),(a,o)=>{const h=I("router-link");return i(),r(x,null,[e("div",N,[O,e("div",q,[C(h,{class:"inline-flex items-center text-xs mb-1 sm:mb-0 sm:mr-2 w-full px-2 h-8 bg-green-600 transition ease-in-out delay-75 hover:bg-green-700 text-white font-medium rounded-md",to:"/movements"},{default:F(()=>[E,c(" Movimientos ")]),_:1}),e("button",{onClick:D,class:"inline-flex items-center text-xs mt-1 sm:mt-0 w-full px-2 h-8 bg-blue-600 transition ease-in-out delay-75 hover:bg-blue-700 text-white font-medium rounded-md"},[R,c(" Guardar ")])])]),e("div",G,[e("div",Z,[e("form",null,[e("div",J,[e("div",null,[e("label",K,[c("Bodega "),l.value.cellar_id?(i(),r("span",Q,"*")):p("",!0)]),e("div",W,[X,b(e("select",{class:v(["w-full bg-white rounded-r-md pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value.cellar_id}]),id:"cellar_id","onUpdate:modelValue":o[0]||(o[0]=t=>s.value.cellar_id=t)},[Y,(i(!0),r(x,null,V(w.value,t=>(i(),r("option",{key:t.id,value:t.id},u(t.nombre),9,ee))),128)),w.value?p("",!0):(i(),r("option",te,"No hay bodegas disponibles"))],2),[[k,s.value.cellar_id]])])]),e("div",null,[e("label",oe,[c("Fecha "),l.value.fecha?(i(),r("span",se,"*")):p("",!0)]),e("div",ae,[le,b(e("input",{type:"date",class:v(["w-full bg-white rounded-r-md pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value.fecha}]),id:"fecha","onUpdate:modelValue":o[1]||(o[1]=t=>s.value.fecha=t),autocomplete:"off"},null,2),[[f,s.value.fecha]])])]),e("div",null,[e("label",re,[c("Tipo Movimiento "),l.value.tipoMovimiento?(i(),r("span",ie,"*")):p("",!0)]),e("div",ne,[de,b(e("select",{class:v(["w-full bg-white rounded-r-md pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value.tipoMovimiento}]),id:"tipoMovimiento","onUpdate:modelValue":o[2]||(o[2]=t=>s.value.tipoMovimiento=t)},he,2),[[k,s.value.tipoMovimiento]])])]),e("div",null,[e("label",pe,[c("Concepto "),l.value.concepto?(i(),r("span",ge,"*")):p("",!0)]),e("div",be,[ve,b(e("input",{type:"text",class:v(["w-full bg-white rounded-r-md pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value.concepto}]),id:"concepto","onUpdate:modelValue":o[3]||(o[3]=t=>s.value.concepto=t),autocomplete:"off"},null,2),[[f,s.value.concepto]])])])]),e("div",me,[e("div",_e,[e("label",xe,[c("Buscar Productos "),l.value.products?(i(),r("span",fe,"*")):p("",!0)]),e("div",we,[ye,b(e("input",{type:"text",class:v(["w-full bg-white rounded-r-md pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value.products}]),id:"searchProduct","onUpdate:modelValue":o[4]||(o[4]=t=>m.value=t),autocomplete:"off",onInput:U},null,34),[[f,m.value]])]),m.value.length>0?(i(),r("div",Ce,[e("ul",null,[(i(!0),r(x,null,V(M.value.slice(0,5),(t,n)=>(i(),r("li",{key:n,class:"text-gray-700 border-b border-gray-300 p-2 flex items-center justify-between"},[e("span",Ve,[c(u(t.descripcion)+" - ",1),e("span",Me,"$ "+u(t.precio),1)]),e("button",{onClick:d=>T(t),class:"ml-2 bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600"},"Agregar",8,ke)]))),128))])])):p("",!0)])]),e("div",Ae,[e("div",ze,[e("table",He,[Be,e("tbody",Pe,[(i(!0),r(x,null,V(s.value.products,(t,n)=>(i(),r("tr",{key:n},[e("td",Ue,[e("div",Te," COD: "+u(_.value[n].product_codigo),1),e("div",$e,u(_.value[n].product_descripcion),1)]),e("td",De,[e("div",Se,[je,c(" "+u(_.value[n].product_marca),1)]),e("div",Fe,[Ie,c(" "+u(_.value[n].product_categoria),1)])]),e("td",Le,[b(e("input",{type:"text",class:v(["w-full bg-white rounded pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value["products."+n+".cantidad"]}]),id:"cantidad","onUpdate:modelValue":d=>t.cantidad=d,autocomplete:"off",onChange:d=>y(t)},null,42,Ne),[[f,t.cantidad]])]),e("td",Oe,[C(z(H),A({type:"text",class:["w-full bg-white rounded pl-2 text-base font-regular outline-0",{"border-red-500 border-2":l.value["products."+n+".costo_unitario"]}],id:"costo_unitario",modelValue:t.costo_unitario,"onUpdate:modelValue":d=>t.costo_unitario=d,autocomplete:"off"},{prefix:"$ ",decimal:".",separator:",",minimumFractionDigits:2},{onChange:d=>y(t)}),null,16,["class","modelValue","onUpdate:modelValue","onChange"])]),e("td",qe,[C(z(H),A({type:"text",class:["w-full bg-white rounded text-base font-regular outline-0",{"border-red-500 border-2":l.value["products."+n+".costo_total"]}],id:"costo_total",modelValue:t.costo_total,"onUpdate:modelValue":d=>t.costo_total=d,autocomplete:"off"},{prefix:"$ ",decimal:".",separator:",",minimumFractionDigits:2},{onChange:d=>y(t),disabled:""}),null,16,["class","modelValue","onUpdate:modelValue","onChange"])]),e("td",Ee,[e("div",Re,[e("a",{onClick:d=>$(n),class:"text-red-500 cursor-pointer hover:text-red-700"},Je,8,Ge)])])]))),128))]),e("tfoot",null,[e("tr",null,[Ke,e("td",Qe,u(Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(s.value.total)),1),We])])])])])])])])],64)}}};export{st as default};
